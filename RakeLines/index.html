<!DOCTYPE html>
<html>
<head>
	<title>RakeLines</title>
	<style type="text/css">
	body {
		background-color: #000;
		padding: 0px;
		margin: 0px;
	}
	canvas {
		height: 100vh;
  		width: 100vw;
  		display: block;
	}
	</style>
</head>
<body>
	<canvas id="canvas"></canvas>
</body>
<script type="text/javascript">

	/**
	 * setup the variables
	 * 
	 * @type {[type]}
	 */
	var canvas 		= document.getElementById('canvas'),
		context 	= canvas.getContext('2d'),
		maxLines 	= 3, 
		lines 		= maxLines,
		dist 		= 15,
		mouseDown 	= false,
		startX 		= 0,
		startY 		= 0,
		height 		= 0,
		width 		= 0,
		gradient 	= 0,
		colour;

	/**
	 * resets the startX/Y coodinates
	 * 
	 * @return {None}
	 */
	function reset () {
		mouseDown = startX = startY = false;
	}


	/**
	 * returns a random colour
	 * @return {String} html hex colour
	 */
	function getRandomColor() {

	    var letters = '0123456789ABCDEF'.split('');
	    var color = '#';
	    for (var i = 0; i < 6; i++ ) {
	        color += letters[Math.floor(Math.random() * 16)];
	    }
	    return color;
	}

	/**
	 * generate a random colour - this is used to generate the gradient
	 * and the shadow
	 */
	colour = getRandomColor();

	/**
	 * setup the canvas context
	 */
	width = canvas.width = document.documentElement.clientWidth;
	height = canvas.height = document.documentElement.clientHeight;

	gradient = context.createLinearGradient(0, 0, width, 0);
	gradient.addColorStop("0", "#000");
	gradient.addColorStop("0.5", colour);
	gradient.addColorStop("1.0", "#000");

	context.translate(0.5, 0.5);
	context.strokeStyle = gradient;
	context.lineWidth = 1.5;

	context.shadowColor = colour;
	context.shadowBlur = 10;
	context.shadowOffsetX = 0;
	context.shadowOffsetY = 0;


	/**
	 * mouseup/mouseout
	 * kill drawing
	 */
	['mouseup', 'mouseout'].forEach(function(evt) {
		canvas.addEventListener(evt, function(el) {
			reset();
		});
	});

	/**
	 * mousedown 
	 * we can draw now
	 */
	canvas.addEventListener("mousedown", function(el) {
		mouseDown = true;
	});

	
	/**
	 * mousemove 
	 * moving the mouse when clicked draws lines
	 */
	canvas.addEventListener("mousemove", function(el) {

		if (mouseDown) {

			// if the centre of the answer circle is (h,k),angle θ,and radius r,then position of point is
			// (h + rcosθ, k + rsinθ)
		
			var x = el.clientX,
				y = el.clientY,
				calcX = (startX || x),
				calcY = (startY || y);

			for (var corners = 1; corners <= 4; corners++) {

				for (var i = 0; i < lines ; i++) {

					context.beginPath();

					// drawing is mirrored in 4 corners
					switch (corners) {
						case 1:
							context.moveTo(x, y - (i * dist));
							context.lineTo(calcX, calcY - (i * dist));	
							break;
						case 2:
							context.moveTo(width - x, height - (y - (i * dist)));
							context.lineTo(width - calcX, height - (calcY - (i * dist)));
							break;
						case 3:
							context.moveTo(x, height - (y - (i * dist)));
							context.lineTo(calcX, height - (calcY - (i * dist)));
							break;
						case 4:
							context.moveTo(width - x, (y - (i * dist)));
							context.lineTo(width - calcX, (calcY - (i * dist)));
							break;
					}
					
					context.stroke();
				}
			}

			startX = x;
			startY = y;			
		}
	});
</script>
</html>